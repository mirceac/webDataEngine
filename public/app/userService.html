<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../components/iron-ajax/iron-ajax.html">
<style>
    .item {
       @apply(--layout-horizontal);
       padding: 5px;
       border-radius: 8px;
       background-color: lightblue;
       border: 2px solid #ddd;
    }
</style>
<dom-module id="user-service">
    <style>

    </style>
    <template>
        <iron-ajax
                id="addUserAction"
                url="/api/users/add"
                method="POST"
                content-type="application/json"
                on-response="userAdded"
                handle-as="json">
        </iron-ajax>

        <iron-ajax
                id="listUsersAction"
                url="/api/users/list"
                last-response="{{data}}"
                auto>
        </iron-ajax>

        <iron-list items="[[data]]" as="item">
            <template>
                <div class="item">
                    User Name: <span>[[item.userName]]</span>
                </div>
            </template>
        </iron-list>
    </template>
</dom-module>
<script>
    Polymer({
       is: "user-service",
       addNew: function(user) {
         this.$.addUserAction.body=JSON.stringify(user);
         this.$.addUserAction.generateRequest();
       },
       userAdded: function() {
         this.$.listUsersAction.generateRequest();
       }
    });
</script>