<link rel="import" href="/assets/components/polymer/polymer.html">
<link rel="import" href="/assets/components/iron-ajax/iron-ajax.html">
<link rel="import" href="/assets/components/iron-list/iron-list.html">
<link rel="import" href="/assets/components/iron-list/iron-list.html">
<link rel="import" href="/assets/components/vaadin-grid/vaadin-grid.html">

<dom-module id="custom-table">
    <style>
        .item {
            @apply(--layout-horizontal);
            padding: 5px;
            border-radius: 8px;
            background-color: lightblue;
            border: 2px solid #ddd;
            width: 100px;
            height: 50px;
        }
        .content {
            display: block;
            position: absolute;
            margin: 0;
            padding: 0;
            width: 98%;
        }
    </style>
    <template>
        <iron-ajax
            url="{{url}}"
            last-response="{{data}}"
            auto>
        </iron-ajax>

        <vaadin-grid items = "{{data}}" selection-mode="multi" class="content">

        </vaadin-grid>
    </template>
</dom-module>
<script>
    Polymer({
       is: "custom-table",
         properties: {
           columns: {
             type: Array,
             value: [{ name: 'Bob' }, { name: 'Doug' } ]
           },
           data: {
             type: Array
           }
         }
    });
    document.addEventListener('WebComponentsReady', function() {
      customTable = document.querySelector('custom-table');
      columns = JSON.parse(customTable.columns);
      data = customTable.data;
      var grid = grid || document.querySelector('vaadin-grid');
      var i;
      grid.sortOrder = [];
      for(i=0; i < columns.length; i++) {
        grid.addColumn({name: columns[i].name}, i);
        grid.columns[i].sortable = true;
        grid.sortOrder.push('{column: ' + i + ', direction: "asc"}');
      }

      // Re-order the data array on sort-order-changed event
      grid.addEventListener('sort-order-changed', function() {
        var idx = grid.sortOrder[0].column;
        var lesser = grid.sortOrder[0].direction == 'asc' ? -1 : 1;
        data.sort(function(a, b) {
          return (a[idx] < b[idx]) ? lesser : -lesser;
        });
      });
    })
</script>